{"ast":null,"code":"import axios from \"axios\";\nimport { getMenuList } from \"@/api/index\";\nexport default {\n  name: \"search\",\n  props: {\n    theme: {\n      type: String,\n      default: \"darkblue\"\n    },\n    type: {\n      type: String,\n      default: \"input\"\n    }\n  },\n  data() {\n    return {\n      key: \"\",\n      list: []\n    };\n  },\n  computed: {},\n  methods: {\n    init() {\n      let menuData = this.getStore(\"menuData\");\n      if (!menuData) {\n        // 第一次加载 读取数据\n        let accessToken = this.getStore(\"accessToken\");\n        // 加载菜单\n        axios.get(getMenuList, {\n          headers: {\n            accessToken: accessToken\n          }\n        }).then(res => {\n          menuData = res.result;\n          this.list = this.getList(menuData);\n        });\n      } else {\n        menuData = JSON.parse(menuData);\n        this.list = this.getList(menuData);\n      }\n    },\n    getList(menuData) {\n      let list = [];\n      menuData.forEach(function (e) {\n        if (e.children && e.children.length > 0) {\n          // 1\n          e.children.forEach(function (c) {\n            if (c.children && c.children.length > 0) {\n              // 2\n              c.children.forEach(function (b) {\n                list.push({\n                  title: b.title,\n                  name: b.name\n                });\n              });\n            }\n          });\n        }\n      });\n      return list;\n    },\n    changeMenu(name111) {\n      if (!name111) {\n        return;\n      }\n      this.$emit(\"changeOk\", name111);\n    },\n    clear() {\n      this.$refs.select.clearSingleSelect();\n    }\n  },\n  mounted() {\n    this.init();\n  }\n};","map":{"version":3,"names":["axios","getMenuList","name","props","theme","type","String","default","data","key","list","computed","methods","init","menuData","getStore","accessToken","get","headers","then","res","result","getList","JSON","parse","forEach","e","children","length","c","b","push","title","changeMenu","name111","$emit","clear","$refs","select","clearSingleSelect","mounted"],"sources":["src/views/home/search.vue"],"sourcesContent":["<template>\r\n<div style=\"position: fixed;\">\r\n    <div :class=\"`search-menu search-menu-theme-${theme}`\" v-if=\"type == 'input'\">\r\n        <Select v-model=\"key\" prefix=\"ios-search\" transfer clearable filterable placeholder=\"请选择添加的模块\" @on-change=\"changeMenu\" ref=\"select\">\r\n            <Option v-for=\"(item, index) in list\" :value=\"item\" :key=\"index\">{{\r\n          item.title\r\n        }}</Option>\r\n        </Select>\r\n        <Icon v-show=\"key\" type=\"ios-close-circle\" class=\"close-icon\" @click=\"clear\" style=\"margin-left: 15px;\" />\r\n    </div>\r\n    <div class=\"search-dropdown\" v-else>\r\n        <Dropdown trigger=\"click\" placement=\"bottom-start\">\r\n            <div style=\"display: inline-block\">\r\n                <div class=\"header-right-icon header-action\">\r\n                    <Icon type=\"ios-search\" :size=\"20\" style=\"margin-left: 15px;\" />\r\n                </div>\r\n            </div>\r\n            <div slot=\"list\" class=\"search-select\">\r\n                <Select v-model=\"key\" prefix=\"ios-search\" transfer clearable filterable placeholder=\"艾是OA菜单查询\" @on-change=\"changeMenu\" ref=\"select\">\r\n                    <Option v-for=\"(item, index) in list\" :value=\"item\" :key=\"index\">{{ item.title }}</Option>\r\n                </Select>\r\n            </div>\r\n        </Dropdown>\r\n    </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport {\r\n    getMenuList\r\n} from \"@/api/index\";\r\nexport default {\r\n    name: \"search\",\r\n    props: {\r\n        theme: {\r\n            type: String,\r\n            default: \"darkblue\",\r\n        },\r\n        type: {\r\n            type: String,\r\n            default: \"input\",\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n            key: \"\",\r\n            list: [],\r\n        };\r\n    },\r\n    computed: {},\r\n    methods: {\r\n        init() {\r\n            let menuData = this.getStore(\"menuData\");\r\n            if (!menuData) {\r\n                // 第一次加载 读取数据\r\n                let accessToken = this.getStore(\"accessToken\");\r\n                // 加载菜单\r\n                axios\r\n                    .get(getMenuList, {\r\n                        headers: {\r\n                            accessToken: accessToken\r\n                        }\r\n                    })\r\n                    .then((res) => {\r\n                        menuData = res.result;\r\n                        this.list = this.getList(menuData);\r\n                    });\r\n            } else {\r\n                menuData = JSON.parse(menuData);\r\n                this.list = this.getList(menuData);\r\n            }\r\n        },\r\n        getList(menuData) {\r\n            let list = [];\r\n            menuData.forEach(function (e) {\r\n                if (e.children && e.children.length > 0) {\r\n                    // 1\r\n                    e.children.forEach(function (c) {\r\n                        if (c.children && c.children.length > 0) {\r\n                            // 2\r\n                            c.children.forEach(function (b) {\r\n                                list.push({\r\n                                    title: b.title,\r\n                                    name: b.name,\r\n                                });\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n            return list;\r\n        },\r\n        changeMenu(name111) {\r\n            if (!name111) {\r\n                return;\r\n            }\r\n            this.$emit(\"changeOk\", name111);\r\n        },\r\n        clear() {\r\n            this.$refs.select.clearSingleSelect();\r\n        },\r\n    },\r\n    mounted() {\r\n        this.init();\r\n    },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.search-menu {\r\n    position: relative;\r\n    display: flex;\r\n    height: 60px;\r\n    align-items: center;\r\n    width: 200px;\r\n\r\n    .ivu-icon {\r\n        font-size: 20px;\r\n    }\r\n\r\n    .close-icon {\r\n        display: none;\r\n        position: absolute;\r\n        font-size: 14px;\r\n        color: #808695;\r\n        right: 8px;\r\n        cursor: pointer;\r\n    }\r\n\r\n    &:hover {\r\n        .close-icon {\r\n            display: block;\r\n        }\r\n    }\r\n\r\n    .ivu-select-selection {\r\n        border: none;\r\n        border-color: none;\r\n        outline: 0;\r\n        box-shadow: none;\r\n        height: 60px;\r\n    }\r\n\r\n    .ivu-select-head-flex {\r\n        height: 60px;\r\n    }\r\n\r\n    .ivu-select-arrow {\r\n        display: none;\r\n    }\r\n\r\n    .ivu-select-selection-focused .ivu-select-arrow,\r\n    .ivu-select-selection:hover .ivu-select-arrow {\r\n        display: none;\r\n    }\r\n\r\n    input::-webkit-input-placeholder {\r\n        color: #999;\r\n    }\r\n\r\n    input::-moz-placeholder {\r\n        color: #999;\r\n    }\r\n\r\n    input::-ms-input-placeholder {\r\n        color: #999;\r\n    }\r\n}\r\n\r\n.search-menu-theme-darkblue {\r\n    .ivu-icon {\r\n        color: hsla(0, 0%, 100%, 0.65);\r\n    }\r\n\r\n    .ivu-select-selection {\r\n        background: #17233d;\r\n    }\r\n\r\n    .ivu-select-input {\r\n        color: hsla(0, 0%, 100%, 0.65);\r\n    }\r\n\r\n    input::-webkit-input-placeholder {\r\n        color: #707786;\r\n    }\r\n\r\n    input::-moz-placeholder {\r\n        color: #707786;\r\n    }\r\n\r\n    input::-ms-input-placeholder {\r\n        color: #707786;\r\n    }\r\n}\r\n\r\n.search-menu-theme-primary {\r\n    .ivu-icon {\r\n        color: #fff;\r\n    }\r\n\r\n    .ivu-select-selection {\r\n        background: #2d8cf0;\r\n    }\r\n\r\n    .ivu-select-input {\r\n        color: #fff;\r\n    }\r\n\r\n    input::-webkit-input-placeholder {\r\n        color: rgb(233, 233, 233);\r\n    }\r\n\r\n    input::-moz-placeholder {\r\n        color: rgb(233, 233, 233);\r\n    }\r\n\r\n    input::-ms-input-placeholder {\r\n        color: rgb(233, 233, 233);\r\n    }\r\n}\r\n\r\n.search-menu-theme-black {\r\n    .ivu-icon {\r\n        color: hsla(0, 0%, 100%, 0.65);\r\n    }\r\n\r\n    .ivu-select-selection {\r\n        background: #1f1f1f;\r\n    }\r\n\r\n    .ivu-select-input {\r\n        color: hsla(0, 0%, 100%, 0.65);\r\n    }\r\n\r\n    input::-webkit-input-placeholder {\r\n        color: #707786;\r\n    }\r\n\r\n    input::-moz-placeholder {\r\n        color: #707786;\r\n    }\r\n\r\n    input::-ms-input-placeholder {\r\n        color: #707786;\r\n    }\r\n}\r\n\r\n.search-dropdown {\r\n    .ivu-select-dropdown {\r\n        padding: 8px 16px;\r\n    }\r\n\r\n    .search-select {\r\n        width: 265px;\r\n    }\r\n}\r\n</style>\r\n"],"mappings":"AA4BA,OAAAA,KAAA;AACA,SACAC,WAAA,QACA;AACA;EACAC,IAAA;EACAC,KAAA;IACAC,KAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,OAAA;IACA;IACAF,IAAA;MACAA,IAAA,EAAAC,MAAA;MACAC,OAAA;IACA;EACA;EACAC,KAAA;IACA;MACAC,GAAA;MACAC,IAAA;IACA;EACA;EACAC,QAAA;EACAC,OAAA;IACAC,KAAA;MACA,IAAAC,QAAA,QAAAC,QAAA;MACA,KAAAD,QAAA;QACA;QACA,IAAAE,WAAA,QAAAD,QAAA;QACA;QACAf,KAAA,CACAiB,GAAA,CAAAhB,WAAA;UACAiB,OAAA;YACAF,WAAA,EAAAA;UACA;QACA,GACAG,IAAA,CAAAC,GAAA;UACAN,QAAA,GAAAM,GAAA,CAAAC,MAAA;UACA,KAAAX,IAAA,QAAAY,OAAA,CAAAR,QAAA;QACA;MACA;QACAA,QAAA,GAAAS,IAAA,CAAAC,KAAA,CAAAV,QAAA;QACA,KAAAJ,IAAA,QAAAY,OAAA,CAAAR,QAAA;MACA;IACA;IACAQ,QAAAR,QAAA;MACA,IAAAJ,IAAA;MACAI,QAAA,CAAAW,OAAA,WAAAC,CAAA;QACA,IAAAA,CAAA,CAAAC,QAAA,IAAAD,CAAA,CAAAC,QAAA,CAAAC,MAAA;UACA;UACAF,CAAA,CAAAC,QAAA,CAAAF,OAAA,WAAAI,CAAA;YACA,IAAAA,CAAA,CAAAF,QAAA,IAAAE,CAAA,CAAAF,QAAA,CAAAC,MAAA;cACA;cACAC,CAAA,CAAAF,QAAA,CAAAF,OAAA,WAAAK,CAAA;gBACApB,IAAA,CAAAqB,IAAA;kBACAC,KAAA,EAAAF,CAAA,CAAAE,KAAA;kBACA9B,IAAA,EAAA4B,CAAA,CAAA5B;gBACA;cACA;YACA;UACA;QACA;MACA;MACA,OAAAQ,IAAA;IACA;IACAuB,WAAAC,OAAA;MACA,KAAAA,OAAA;QACA;MACA;MACA,KAAAC,KAAA,aAAAD,OAAA;IACA;IACAE,MAAA;MACA,KAAAC,KAAA,CAAAC,MAAA,CAAAC,iBAAA;IACA;EACA;EACAC,QAAA;IACA,KAAA3B,IAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}