{"version":3,"file":"list-radio.js","sourceRoot":"","sources":["../../../../src/interaction/action/component/list-radio.ts"],"names":[],"mappings":"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","sourcesContent":["import ListState from './list-state';\nimport { isEqual } from '@antv/util';\nimport { TOOLTIP_CSS_CONST } from '@antv/component';\nimport { HtmlTooltip } from '../../../dependents';\nimport { Point } from '../../../interface';\n\nconst STATUS_SHOW = 'showRadio';\nconst TIP_ID = 'legend-radio-tip';\n\nclass ListRadio extends ListState {\n  public show() {\n    const triggerInfo = this.getTriggerListInfo();\n    if (triggerInfo?.item) {\n      const { list, item } = triggerInfo;\n      list.setItemState(item, STATUS_SHOW, true);\n    }\n  }\n\n  public hide() {\n    const triggerInfo = this.getTriggerListInfo();\n    if (triggerInfo?.item) {\n      const { list, item } = triggerInfo;\n      list.setItemState(item, STATUS_SHOW, false);\n    }\n  }\n\n  private timeStamp: number = 0;\n  private location: Point;\n  private tooltip;\n\n  public destroy() {\n    super.destroy();\n    this.tooltip && this.tooltip.destroy();\n  }\n\n  /**\n   * 显示 Tooltip (展示在上方)\n   * @returns\n   */\n  public showTip() {\n    const context = this.context;\n    const ev = context.event;\n    const lastTimeStamp = this.timeStamp;\n    const timeStamp = +new Date();\n\n    const target = this.context.event.target;\n    if (timeStamp - lastTimeStamp > 16 && target.get('name') === 'legend-item-radio') {\n      const preLoc = this.location;\n      const curLoc = { x: ev.x, y: ev.y };\n      this.timeStamp = timeStamp;\n      this.location = curLoc;      \n      if (!preLoc || !isEqual(preLoc, curLoc)) {\n        this.showTooltip(curLoc);\n      }\n    }\n  }\n\n  /**\n   * 隐藏 Tooltip。\n   * @returns\n   */\n  public hideTip() {\n    this.hideTooltip();\n    this.location = null;\n  }\n\n  protected showTooltip(curLoc: Point) {\n    const context = this.context;\n    const ev = context.event;\n    const target = ev.target;\n\n    if (target && target.get('tip')) {\n      if (!this.tooltip) {\n        this.renderTooltip(); // 延迟生成\n      }\n      // 展示 tooltip\n      const { x: offsetX, y: offsetY } = context.view.getCanvas().get('el').getBoundingClientRect();\n      this.tooltip.update({\n        title: target.get('tip'),\n        ...curLoc,\n        x: curLoc.x + offsetX,\n        y: curLoc.y + offsetY,\n      });\n      this.tooltip.show();\n    }\n  }\n\n  protected hideTooltip() {\n    this.tooltip && this.tooltip.hide();\n  }\n\n  private renderTooltip() {\n    const tooltipStyles = {\n      [TOOLTIP_CSS_CONST.CONTAINER_CLASS]: {\n        padding: '6px 8px',\n        transform: 'translate(-50%, -80%)',\n        background: 'rgba(0,0,0,0.75)',\n        color: '#fff',\n        'border-radius': '2px',\n        // 避免遮挡，如果还不够的话，再考虑开放用户配置\n        'z-index': 100,\n      },\n      [TOOLTIP_CSS_CONST.TITLE_CLASS]: {\n        'font-size': '12px',\n        'line-height': '14px',\n        'margin-bottom': 0,\n        'word-break': 'break-all',\n      }\n    };\n    if (document.getElementById(TIP_ID)) {\n      document.body.removeChild(document.getElementById(TIP_ID));\n    }\n    const tooltip = new HtmlTooltip({\n      parent: document.body,\n      // tooltip 限制的区域\n      region: null,\n      visible: false,\n      crosshairs: null,\n      domStyles: tooltipStyles,\n      containerId: TIP_ID,\n    });\n    tooltip.init();\n    tooltip.setCapture(false); // 不允许捕获事件\n    this.tooltip = tooltip;\n  }\n}\n\nexport default ListRadio;\n"]}